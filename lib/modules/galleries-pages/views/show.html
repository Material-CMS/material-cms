{% extends "layout.html" %}

{% block main %}

  <div class="main-content">
    <div class="pages-container">

      {% if data.piece.title %}
        <h2 class="accent-color center-align"
          {% if data.piece.titleColor %} style="color:{{ data.piece.titleColor }}" {% endif %}
        >
          {{ data.piece.title }}
        </h2>
      {% endif %}

      {% if data.piece.container == true %}
        <div class="container">
      {% endif %}

          <div class="row">
            <div class="col s12 m12">

              {% if data.piece.card == true and data.piece.container == true %}
                <div class="radius
                  {% if data.page.shadow %}
                    z-depth-1
                  {% endif %}
                ">
                  <div class="card">
                    <div class="card-content no-padding-mobile">
              {% endif %}

                      <div class="row">
                        <div class="col s12 m12">

                          <div class="gallery">

                            <div class="images column-count-{{ data.piece.columnCount }}">

                              {% for _image in data.piece._images %}
                                <div class="images-container{% if data.piece.forceAspectRatio %} ratio-1-1{% endif %}">
                                  <div class="image-radius{% if data.piece.imagesShadow %} z-depth-1{% endif %}">

                                    <div class="card">

                                      <div class="height-100 {% if data.piece.lightboxOn %} lightbox{% endif %}">

                                        <div class="card-image">
                                          <img src="{{ apos.attachments.url(_image.attachment, { size: 'one-third', crop: relationship }) }}"
                                            srcset="{{ apos.images.srcset(_image.attachment) }}"
                                            sizes="(min-width:1200px)20vw, 30vw"
                                            alt="{{ _image.title }}"
                                            width="100%"
                                          >
                                        </div>

                                        {% if piece.lightboxOn %}

                                          <div class="lightbox-overlay"
                                            {% if data.widget.overlayColor %}
                                              style="background-color: {{ data.widget.overlayColor }}"
                                            {% endif %}
                                          ></div>

                                          <div class="lightbox-image image-radius">
                                            {% if data.widget.lightboxNoCrop %}
                                              <img
                                                data-src="{{ apos.attachments.url(_image.attachment, { size: 'full' }) }}"
                                                srcset="{{ apos.images.srcset(_image.attachment) }}"
                                                sizes="{{ data.options.sizesAttr or '100vw' }}"
                                                alt="{{ image.title }}"
                                              >
                                            {% else %}
                                              <img
                                                data-src="{{ apos.attachments.url(_image.attachment, { size: 'full', crop: relationship }) }}"
                                                srcset="{{ apos.images.srcset(_image.attachment, relationship ) }}"
                                                sizes="{{ data.options.sizesAttr or '100vw' }}"
                                                alt="{{ image.title }}"
                                              >
                                            {% endif %}
                                          </div>

                                        {% endif %}

                                      </div>

                                    </div>
                                  </div>

                                </div>
                              {% endfor %}

                            </div>

                          </div>

                        </div>
                      </div>

              {% if data.piece.card == true and data.piece.container == true %}
                    </div>
                  </div>
                </div>
              {% endif %}

            </div>
          </div>

      {% if data.piece.container == true %}
        </div>
      {% endif %}

    </div>
  </div>

{% endblock %}
