{% import 'components/automatic.html' as automatic with context %}
{% import 'components/manual.html' as manual with context %}

<div class="nav">

  {# Nav Background #}
  {% if data.widget._navBackgroundImage or data.global._navBackgroundImage %}
    {% include "components/background.html" %}
  {% endif %}

  {# Desktop #}
  <nav class="nav-extended{% if data.widget._navBackgroundImage or data.global._navBackgroundImage %} nav-pushpin{% endif %}"
    {% set regExp = r/^#.*/g %}
    {% if regExp.test(data.global.navColor or data.widget.navColor) %}
      style="height: 64px"
    {% endif %}
  >

    {# Nav Wrapper #}
    <div class="nav-wrapper pin-top nav-color{% if data.widget.navShadow or data.global.navShadow %} z-depth-2{% endif %}"
    {% if data.widget.navColor or (data.widget._navBackgroundImage or data.global._navBackgroundImage) %}
      style="
        {% if data.widget.navColor %}
          background-color: {{ data.widget.navColor}};
        {% endif %}
        {% if data.widget._navBackgroundImage or data.global._navBackgroundImage %}
          position: relative;
        {% endif %}
      "
    {% endif %}
    >

    {# Brand Logo #}
    <a class="brand-logo" href="{{ data.options.homeUrl }}">
      {% if data.widget._logo %}
        <img
          src="{{ apos.attachments.url(data.widget._logo.attachment, { size: 'full' }) }}"
          alt="{{ data.widget._logo.description }}"
        >
      {% else %}
        {% if data.global._logo %}
          <img
            src="{{ apos.attachments.url(data.global._logo.attachment, { size: 'full' }) }}"
            alt="{{ data.global._logo.description }}"
          >
        {% else %}
          <h1 class="accent-color"
            {% if data.widget.navTextColor or data.global.navTextColor %}
              style="color: {{ data.widget.navTextColor or data.global.navTextColor }}"
            {% endif %}
            >
            {{ data.options.homeTitle }}
          </h1>
        {% endif %}
      {% endif %}
    </a>

      {# Sidenav Trigger #}
      <a href="#" data-target="mobile" class="accent-color sidenav-trigger"
        {% if data.widget.navTextColor or data.global.navTextColor %}
          style="color: {{ data.widget.navTextColor or data.global.navTextColor }}"
        {% endif %}
      >
        <i class="material-icons">menu</i>
      </a>

      <ul class="nav-activator right hide-on-med-and-down">

        {# Extra Links #}
        {% include "components/extra-links.html" %}

        {# Include Nav #}
        {% if data.widget.nav == 'default' %}
          {{ automatic.base('dropdown-desktop','dropdown-trigger-hover', '') }}
        {% elif data.widget.nav == 'manual' and data.widget._pieces.length %}
          {{ manual.base('dropdown-desktop','dropdown-trigger-hover') }}
        {% else %}
          <div class="apos-area apos-empty">
            <i class="material-icons">clear</i>
            <p class="flow-text">no navigation<p>
          </div>
        {% endif %}

      </ul>

    </div>
  </nav>

</div>

{# Mobile Sidenav #}
<ul class="sidenav" id="mobile">

  {# Extra Links #}
  {% include "components/extra-links.html" %}

  {# Include Nav #}
  {% if data.widget.nav == 'default' %}
    {{ automatic.base('dropdown-mobile','dropdown-trigger', 'sidenav-close') }}
  {% elif data.widget.nav == 'manual' and data.widget._pieces.length  %}
    {{ manual.base('dropdown-mobile','dropdown-trigger') }}
  {% else %}
    <div class="apos-area apos-empty">
      <i class="material-icons">clear</i>
      <p class="flow-text">no navigation<p>
    </div>
  {% endif %}

</ul>
